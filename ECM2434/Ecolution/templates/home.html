{% extends "base.html" %}
{% load static %}

{% block title %}
    <title>Home - Ecolution</title>
{% endblock %}

{% block main %}
    <section class="pet">
        <div class="flex_v flex_center">
            <div class="image_wrapper">
                {% if pet %}
                    <img src="{{ pet.computed_image_url }}" alt="{{ pet.pet_type }} pet">
                    {% if hat %}
                        <img src="{% static hat.image_path %}" class="hat {{ pet.pet_type }} {{ pet.size }}" alt="Hat">
                    {% endif %}
                {% else %}
                    <img src="{% static 'images/pets/mushroom/mushroom_large.gif' %}" alt="Default Pet">
                {% endif %}
            </div>
        </div>
    </section>

    <section class="cycle_pet_section flex_h flex_center">
        {% if request.user.pet_set.count > 1 %}
        <button class="button box_shadow text_light button_alt"
                style="margin-right: 1rem;"
                onclick="window.location.href='{% url 'cycle_pet' %}'">
            Cycle Pet
        </button>
        {% endif %}

        <button class="button box_shadow text_light button_alt"
                onclick="window.location.href='{% url 'select_accessory' %}'">
            Select Accessories
        </button>
    </section>

    <section class="status_bar flex_h flex_center text_light">
        <div class="pet_status flex_v margin_sml flex_v_fill">
            <div class="pet_info_bar flex_h" style="justify-content: space-between;"> <!-- this displays the pets name and level -->
                <p>Pet Name: {{ pet_name }}</p>
                <p>Level: {{ level }}</p>
            </div>
            <div class="xp_bar box_shadow">
                <div class="xp_bar_progress" style="width: {{ pet_exp }}%;"></div> <!-- this is a bar with the amount of xp that the pet has -->
            </div>
            <div class="flex_h">
                <p class="xp_bar_label" id="xp_bar_xp_current">{{ pet_exp }}XP</p> <!-- this is the amount of xp the pet currently has -->
                <p class="xp_bar_label" id="xp_bar_xp_to_next_level">100XP</p> <!-- this is the amount the pet needs to reach the next level it should always be set to 100 -->
            </div>
        </div>
    </section>
    <section class="current_tasks">
        <section class="heading flex_h">
            <div class="flex_v">
                <h2 class="text_light">Current Tasks</h2>
                <p class="text_light">Select a task to view or edit details</p>
            </div>
            <button class="button box_shadow text_light" type="button" onclick="window.location.href='{% url 'tasks' %}'">View All</button>
        </section>
        {% for user_task in user_tasks %}
            {% include 'partials/task_card.html' with user_task=user_task %}
        {% empty %}
        <section class="card box_shadow text_light">
            <div class="content flex_h flex_fill_h flex_center flex_gap_std margin_sml">
                <p>You don't have any tasks, </p>
                <a href="{% url 'tasks' %}">lets add one!</a>
                <!-- <button class="button_alt text_light" type="button" onclick="window.location.href='{% url 'tasks' %}'">lets add one!</button> -->
            </div>
        </section>
        
            
        {% endfor %}
    </section>
{% endblock %}
